Feature: 開始販售時刻表
  影城管理者可以將某日期的時刻表從草稿狀態轉為販售中狀態
  販售後該日期的場次無法再編輯

  Background:
    Given 管理者已登入系統

  Rule: 只有草稿狀態的時刻表可以開始販售
    Example: 草稿狀態可開始販售
      Given 日期「2025-12-22」的時刻表狀態為 Draft
      When 管理者點擊「開始販售」按鈕
      And 管理者確認販售
      Then 日期「2025-12-22」的時刻表狀態為 OnSale

    Example: 無場次也可開始販售
      Given 日期「2025-01-01」的時刻表狀態為 Draft
      And 該日期沒有任何場次
      When 管理者點擊「開始販售」按鈕
      And 管理者確認販售
      Then 日期「2025-01-01」的時刻表狀態為 OnSale

    Example: 已販售狀態無法再次販售
      Given 日期「2025-12-22」的時刻表狀態為 OnSale
      When 管理者查看時刻表管理頁面
      Then 系統不顯示「開始販售」按鈕

  Rule: 販售確認需要二次確認
    Example: 顯示確認對話框
      Given 日期「2025-12-22」的時刻表狀態為 Draft
      When 管理者點擊「開始販售」按鈕
      Then 系統顯示確認對話框
      And 對話框標題為「開始販售」
      And 對話框訊息為「確定要開始販售 2025/12/22(一) 的電影票嗎？」
      And 對話框警告為「販售後就無法再度編輯該日的電影時刻表」

    Example: 取消販售
      Given 日期「2025-12-22」的時刻表狀態為 Draft
      And 系統顯示販售確認對話框
      When 管理者點擊「取消」按鈕
      Then 日期「2025-12-22」的時刻表狀態仍為 Draft

  Rule: 販售後該日期的場次無法編輯
    Example: 販售中狀態禁止新增場次
      Given 日期「2025-12-22」的時刻表狀態為 OnSale
      When 管理者嘗試在日期「2025-12-22」新增場次
      Then 操作失敗

    Example: 販售中狀態禁止編輯場次
      Given 日期「2025-12-22」的時刻表狀態為 OnSale
      And 場次「誅仙 - 2025/12/22 09:00」已存在
      When 管理者嘗試編輯該場次
      Then 操作失敗

    Example: 販售中狀態禁止刪除場次
      Given 日期「2025-12-22」的時刻表狀態為 OnSale
      And 場次「誅仙 - 2025/12/22 09:00」已存在
      When 管理者嘗試刪除該場次
      Then 操作失敗

  Rule: 販售狀態不可逆轉
    Example: OnSale 無法轉回 Draft
      Given 日期「2025-12-22」的時刻表狀態為 OnSale
      When 管理者查看時刻表管理頁面
      Then 系統不提供將時刻表轉為草稿狀態的功能
