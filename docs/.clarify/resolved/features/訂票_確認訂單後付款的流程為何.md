# 訂票_確認訂單後付款的流程為何

訂票功能中,確認訂單後付款的流程為何？

# 定義

Feature：訂票功能
Rule：確認訂單後必須付款

# 多選項

| 選項 | 描述 |
|--------|-------------|
| A | 建立 Order（待付款）→ 付款成功 → 建立 Ticket |
| B | 建立 Order 與 Ticket（待付款）→ 付款成功 → 更新狀態 |
| C | 付款成功 → 建立 Order 與 Ticket |
| Short | 其他（請簡短答案<=5 字）|

# 影響範圍

- Order 與 Ticket 的建立時機
- Order 與 Ticket 的狀態轉換邏輯
- 訂票功能的前置邏輯
- 付款失敗的處理邏輯

# 優先級

High
- 影響訂票流程的核心設計
- 影響 Order 與 Ticket 的狀態週期

---

# 釐清記錄

**使用者選擇：B**

**規格文件變更：**
- `spec/features/訂票.feature` - 更新規則說明：
  - Rule「確認訂單後必須付款」的流程說明（建立Order 與 Ticket（狀態為待付款）→ 付款成功 → 更新狀態為已付款）
  - Rule「付款失敗時保留訂單與票券」修改為「付款失敗時重新訂單與票券狀態保持確認待付款」

---

# 解決記錄

- **決議**：B  確認訂單後建立訂單與票券,使用者付款前座位「待付款」
- **流程**：選座 → 確認訂單 → 建立訂單（座位、票券、訂單）→ 付款 → 導向 LINE Pay
- **更新規格檔案**：spec/features/訂票.feature
