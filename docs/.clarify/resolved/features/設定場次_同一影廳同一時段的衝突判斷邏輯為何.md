# 釐清問題

設定場次功能中，同一影廳同一時段的衝突判斷邏輯為何？

# 定位

Feature：設定場次功能
Rule：同一影廳在同一時段只能播放一部電影

# 多選題

| 選項 | 描述 |
|--------|-------------|
| A | 檢查開始時間是否完全相同 |
| B | 檢查時間區間是否有重疊（開始到結束時間） |
| C | 檢查同一日期的同一時段（如：早場、午場、晚場） |
| Short | 提供其他簡短答案（<=5 字）|

# 影響範圍

- MovieShowTime 實體的跨屬性不變條件
- 設定場次功能的前置條件驗證
- 場次衝突檢查邏輯
- 測試案例設計

# 優先級

High
- 影響場次排程的核心邏輯
- 影響場次衝突的判斷方式

---

# 解決記錄

**使用者選擇：B**

**規格文件變更：**
- `spec/erm.dbml` - 更新 MovieShowTime 實體的跨屬性不變條件：
  - 修改為：同一個 theater_id 在同一個 show_date 的時間區間 [show_time, end_time] 不可有重疊

- `spec/features/設定場次.feature` - 更新規則說明：
  - Rule「同一影廳在同一時段只能播放一部電影」：明確衝突判斷邏輯為檢查時間區間是否有重疊，重疊定義為 (new_start < existing_end) AND (new_end > existing_start)
