# 訂票_何時更新Order狀態為已完成

Order 的狀態應該更新為「已完成」是在驗票後、場次結束後,還是其他條件？

# 定義

ERM：Order.order_status = 已完成
Feature：訂票功能包含訂單狀態週期

# 多選項

| 選項 | 描述 |
|--------|-------------|
| A | 場次結束後自動標記為已完成 |
| B | 只要一張票券被驗票（已入場）就標記為已完成 |
| C | 所有票券都被驗票才標記為已完成 |
| D | 使用者手動確認或系統定時標記 |
| Short | 其他方式 |

# 影響範圍

- Order 狀態轉換週期的定義
- 訂票記錄查詢與統計邏輯
- 報表與數據的準確性

# 優先級

Medium

---

**說明**：「已完成」的定義不確定義,需要確認其確切語意以便於系統設計與業務流程。

---

# 解決記錄

- **決議**：B  收到 LINE Pay Webhook 回應才更新
- **理由**：付款為非同步,數據需為真,確保數據一致性,避免付款與訂單狀態不一致
- **更新規格檔案**：spec/features/訂票.feature、付款流程規範
